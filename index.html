<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Trace Type</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="container">
    <!-- ヘッダー -->
    <header>
      <div class="header-content">
        <div class="title-section">
          <h1>Trace Type</h1>
          <h3>Created by Dit-Lab.（Daiki ITO）</h3>
        </div>
        <div class="header-controls">
          <button id="dark-mode-toggle" class="theme-toggle" title="ダークモード切り替え">
            <span class="theme-icon" id="theme-icon">🌙</span>
          </button>
        </div>
      </div>
    </header>

    <!-- 指示メッセージエリア -->
    <section class="instructions">
      <div class="instruction-item">📱 <strong class="highlight-key">マウスを使わずに</strong>タイピングしよう</div>
      <div class="instruction-item">🔄 変換は<kbd class="key-highlight">スペースキー</kbd></div>
      <div class="instruction-item">⭐ 予測変換は<kbd class="key-highlight">Tabキー</kbd></div>
    </section>

    <!-- ファイル選択エリア -->
    <section class="selector">
      <label for="file-select">練習テキストを選択：</label>
      <select id="file-select" disabled>
        <!-- JS がここに option を追加 -->
      </select>
      <button id="start-btn" disabled>スタート</button>
    </section>

    <!-- キー表示エリア -->
    <section class="key-display-area">
      <div class="key-display-label">入力すべきキー: <span id="input-mode-indicator"></span></div>
      <div id="key-display" class="key-display"></div>
      <div id="ime-composition-display" class="ime-composition-display"></div>
    </section>


    <!-- タイピングエリア -->
    <section class="typing-area">
      <!-- 背景に練習テキストを表示する領域 -->
      <div id="text-display" class="text-display"></div>

      <!-- IME Preview Area -->
      <div id="ime-preview" class="ime-preview"></div>

      <!-- キー入力を受け取る透明テキストエリア -->
      <textarea
        id="text-input"
        class="text-input"
        placeholder=""
        disabled
        spellcheck="false"
      ></textarea>
    </section>

    <!-- IME Status Indicator -->
    <div id="ime-indicator" class="ime-indicator">
      日本語入力中...
    </div>

    <!-- 進捗バー -->
    <section class="progress-section" id="progress-section" style="display: none;">
      <div class="progress-bar-container">
        <div class="progress-bar" id="progress-bar"></div>
        <div class="progress-text" id="progress-text">0%</div>
      </div>
    </section>

    <!-- 結果表示エリア -->
    <section class="result-area">
      <div class="stats-grid" id="stats-grid">
        <div class="stat-item">
          <span class="stat-label">経過時間</span>
          <span class="stat-value" id="timer">0.00</span>
          <span class="stat-unit">秒</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">入力文字</span>
          <span class="stat-value" id="input-chars">0</span>
          <span class="stat-unit">文字</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">WPM</span>
          <span class="stat-value" id="real-time-wpm">0</span>
          <span class="stat-unit">WPM</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">クリック</span>
          <span class="stat-value" id="mouse-clicks">0</span>
          <span class="stat-unit">回</span>
        </div>
      </div>
      <!-- Stats Toggle Button (only visible on low resolution) -->
      <button class="stats-toggle" id="stats-toggle" style="display: none;">📊</button>
    </section>

    <!-- スコア表示エリア -->
    <section class="score-area" id="score-area" style="display: none;">
      <h2>タイピング結果</h2>
      <div class="score-grid">
        <div class="score-item">
          <div class="score-label">WPM</div>
          <div class="score-value" id="wpm-score">0</div>
        </div>
        <div class="score-item">
          <div class="score-label">CPM</div>
          <div class="score-value" id="cpm-score">0</div>
        </div>
        <div class="score-item">
          <div class="score-label">正確率</div>
          <div class="score-value" id="accuracy-score">0%</div>
        </div>
        <div class="score-item">
          <div class="score-label">総文字数</div>
          <div class="score-value" id="total-chars">0</div>
        </div>
        <div class="score-item">
          <div class="score-label">正解数</div>
          <div class="score-value" id="correct-chars">0</div>
        </div>
        <div class="score-item">
          <div class="score-label">誤字数</div>
          <div class="score-value" id="error-chars">0</div>
        </div>
      </div>
      <button id="retry-btn" class="retry-button">もう一度</button>
    </section>
  </div>

  <script src="script.js"></script>
</body>
</html>
